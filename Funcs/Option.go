package Funcs

import (
	"Exploit/Data"
	"Exploit/Funcs/options"
	"fmt"
)

func Option(){
	options.FindFile(Data.ConfigJsonMap.Exploit.Path,Data.UserObject.KeyWord)
	if Data.UserObject.JsonFile != "" && Data.UserObject.OriAddr != ""{
		options.JudgeMent()
		if Data.UserObject.Header == true{
			fmt.Println("-----------------------------------------------------------------------------------------")
			fmt.Println(Data.RespObject.Resp.Header)
		}
		if Data.UserObject.Body == true{
			fmt.Println("-----------------------------------------------------------------------------------------")
			if len(Data.ExpJsonMap.Regexps) > 0{
				for _,value := range Data.ExpJsonMap.Regexps{
					result := options.FechRegex(fmt.Sprintf("%s",value),fmt.Sprintf("%s",Data.RespObject.Body))
					for _,value2:= range result {
						if len(value) > 0{
							fmt.Println(fmt.Sprint(value2[1:]))
						}
					}
					fmt.Println(result)
				}
			}else{
				fmt.Println(Data.RespObject.Body)
			}
		}
		if Data.FlageStatus == true{
			fmt.Println("-----------------------------------------------------------------------------------------")
			options.SuccessPrint("Exploit Success !")
		}else{
			fmt.Println("-----------------------------------------------------------------------------------------")
			options.FailPrint("Exploit Failed !")
		}
	}
}
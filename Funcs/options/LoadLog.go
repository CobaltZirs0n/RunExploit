package options

import (
	"Exploit/Data"
	"encoding/json"
	"fmt"
	"io"
	"io/ioutil"
	"log"
	"os"
)

func init() {
	file, err := os.Open("./config.json")
	if err != nil {
		fmt.Println("Can't found config.json file")
		os.Exit(1)
	}
	fileValue, err := ioutil.ReadAll(file)
	if err != nil {
		fmt.Println("Can't loaded config.json file")
		os.Exit(1)
	}
	err = json.Unmarshal(fileValue, &Data.ConfigJsonMap)
	if err != nil {
		fmt.Println("Can't to read config.json file")
	}
	FileLog, err := os.OpenFile(Data.ConfigJsonMap.Exploit.Logs,os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666)
	if err != nil {
		fmt.Println("Can't to build " + Data.ConfigJsonMap.Exploit.Logs)
		os.Exit(1)
	}

	Data.ColorInfo = log.New(os.Stdout, "[INFO]", log.Ldate|log.Ltime)
	Data.ColorMistake = log.New(io.MultiWriter(FileLog, os.Stderr), "[ERROR]", log.Ldate|log.Ltime|log.Lshortfile)
	Data.ColorSend = log.New(os.Stdout, "[MESSAGE-SEND]", log.Ldate|log.Ltime)
	Data.ColorSuccess = log.New(os.Stdout, "[SUCCESS]", log.Ldate|log.Ltime)
	Data.ColorFail = log.New(io.MultiWriter(FileLog, os.Stderr), "[FAILED]", log.Ldate|log.Ltime)
}
